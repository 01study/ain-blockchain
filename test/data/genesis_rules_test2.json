{
  ".write": false,
  "accounts": {
    ".write": true
  },
  "afan": {
    ".write": true
  },
  "consensus": {
    "recent_proposers": {
      ".write": "(newData.length < 20) && (getValue('/consensus/voting/pre_commits') > getValue('/consensus/voting/threshold')) && (getValue('/consensus/voting/proposer') === auth)"
    },
    "stakes": {
      "$uid": {
        ".write": "auth === $uid"
      }
    },
    "voting": {
      ".write": "getValue('/consensus/voting') === null || getValue('/consensus/recent_proposers') !== null && (getValue('/consensus/recent_proposers')[getValue('/consensus/recent_proposers').length - Math.floor((currentTime - getValue('/consensus/voting/time')) / 6000)] === auth)" ,
      "block_hash": {
        ".write": "getValue('/consensus/voting/proposer') === auth"
      },
      "next_round_validators": {
        ".write": "Object.keys(getValue('/consensus/stakes')).indexOf(auth) > -1"
      },
      "pre_votes":{
        ".write": "getValue('/consensus/voting/block_hash') !== null"
      },
      "pre_commits": {
        ".write":  "getValue('/consensus/voting/pre_votes') > getValue('/consensus/voting/threshold')"
      }
    }
  },
  "deposit": {
    "$service_id": {
      "$uid": {
        "$deposit_id": {
          "value": {
            ".write": "auth === $uid && !getValue('/deposit/' + $service_id + '/' + $uid + '/' + $deposit_id) && getValue('/accounts/' + $uid + '/balance') >= newData"
          },
          "createdAt": {
            ".write": false
          }
        }
      }
    }
  },
  "deposit_accounts": {
    ".write": false,
    "$service_id": {
      "config": {
        ".write": "!getValue('/deposit_accounts/' + $service_id) || (getOwner('/deposit_accounts/' + $service_id) && getOwner('/deposit_accounts/' + $service_id).owners && getOwner('/deposit_accounts/' + $service_id).owners[auth])"
      },
      "$uid": {
        ".write": false
      }
    },
    "consensus": {
      "config": {
        ".write": false
      }
    }
  },
  "nested":{
    ".write": true
  },
  "new":{
    ".write": true
  },
  "test": {
    ".write": true,
    "ai": {
    },
    "comcom": {
    },
    "billing_keys": {
      "update_billing": {
      }
    },
    "users":{
      "$uid": {
        ".write": "auth === $uid",
        "balance": {
          ".write": "typeof newData === 'number' && newData >= 0"
        },
        "info": {
          ".write": "data !== null"
        },
        "balance_info": {
          ".write": "getValue('test/billing_keys/update_billing/' + $uid) !== null"
        },
        "next_counter": {
          ".write": "typeof newData === 'number' && newData === data + 1"
        }
      }
    },
    "second_users": {
      "$wcard1":{
        "$wcard2": {
          ".write": "$wcard1 == $wcard2"
        }
      }
    },
    "no_dup_key": {
      "$key1": {
        "$key2": {
          ".write": true
        }
      }
    },
    "dup_key": {
      "$key1": {
        "$key1": {
          ".write": true
        }
      }
    }
  },
  "transfer": {
    "$from": {
      "$to": {
        "$key": {
          "value": {
            ".write": "auth === $from && !getValue('transfer/' + $from + '/' + $to + '/' + $key) && getValue('accounts/' + $from + '/balance') >= newData"
          }
        }
      }
    }
  },
  "withdraw":{
    "$service_id": {
      "$uid": {
        "$withdraw_id": {
          "value": {
            ".write": "auth === $uid && !getValue('/withdraw/' + $service_id + '/' + $uid + '/' + $withdraw_id) && getValue('/deposit_accounts/' + $service_id + '/' + $uid + '/value') >= newData"
          },
          "createdAt": {
            ".write": false
          }
        }
      }
    }
  }
}
